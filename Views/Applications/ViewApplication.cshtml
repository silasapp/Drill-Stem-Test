@using DST.Helpers
@model IEnumerable<DST.Models.GeneralModel.ApplicationDetailsModel>
@using Microsoft.AspNetCore.Http;
@using DST.Controllers.Authentications;


@{
    ViewData["Title"] = "View Application for : " + ViewData["AppRefNo"].ToString();
    Layout = "~/Views/Shared/_ElaLayout.cshtml";
    GeneralClass generalClass = new GeneralClass();

    var buttonName = "";

    if (generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.HEAD_UMR || generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.AD_UMR)
    {
        buttonName = "Approve";
    }
    else
    {
        buttonName = "Pass for Approval";
    }
}

<h1>@ViewData["Title"]</h1>

<br />

<div class="card-black">

    @foreach (var apps in Model)
    {
        foreach (var r in apps.applications)
        {
            var symbol = r.ShortName == GeneralClass.EEWT || r.ShortName == GeneralClass.NEWT ? "$" : "₦";

            var companyemail = generalClass.Encrypt(r.CompanyEmail.ToString());
            var appId = generalClass.Encrypt(r.AppId.ToString());

            <input type="text" id="txtDeskID" hidden value="@generalClass.Encrypt(r.DeskId.ToString())" />
            <input type="text" id="txtAppId" hidden value="@generalClass.Encrypt(r.AppId.ToString())" />
            <input type="text" id="txtAppStage" hidden value="@Model.FirstOrDefault().applications.FirstOrDefault().ShortName" />
            <input type="text" id="Insshowpush" value="@r.DeskId" hidden />


            <div class="card-body">

                <div class="row">

                    <div class="col-sm-5">

                        <div class="table-responsive">

                            <table class="table table-bordered table-striped" style="resize:vertical">
                                <tbody>

                                    <tr>
                                        <td style="width:170px">Ref NO </td>
                                        <td class="text-left text-primary"><b>@r.RefNo</b></td>
                                    </tr>

                                    <tr>
                                        <td>View uploaded template </td>
                                        <td class="text-left"><a class="btn btn-danger btn-sm" href="/Applications/ViewTemplate/@appId" target="_blank">View Template</a></td>
                                    </tr>

                                    @if (r.ShortName == GeneralClass.DST)
                                    {
                                        <tr>
                                            <td>Is Approved</td>
                                            <td class="text-left"><b>@r.ProposalApproved</b></td>
                                        </tr>

                                        <tr>
                                            <td>Is Report Approved</td>
                                            <td class="text-left"><b>@r.ReportApproved</b></td>
                                        </tr>
                                    }

                                    <tr>
                                        <td class="">Company Name</td>
                                        <td class="text-left">
                                            <a class="text-primary" href="/Companies/FullCompanyProfile/@companyemail" target="_blank"><b> @r.CompanyName </b></a>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>Company Address</td>
                                        <td class="text-left"> @r.CompanyAddress</td>
                                    </tr>

                                    <tr>
                                        <td class="">Company Email</td>
                                        <td class="text-left">@r.CompanyEmail </td>
                                    </tr>

                                    <tr>
                                        <td>Stage</td>
                                        <td class="text-left text-dark"><b>@r.Stage</b></td>
                                    </tr>

                                    <tr>
                                        <td> Status </td>

                                        @{
                                            var status =
                                             r.Status == GeneralClass.Rejected ? "btn-danger" :
                                             r.Status == GeneralClass.DISAPPROVE ? "btn-danger" :
                                             r.Status == GeneralClass.PaymentPending ? "btn-info" :
                                             r.Status == GeneralClass.Processing ? "btn-warning" :
                                             r.Status == GeneralClass.PaymentCompleted ? "btn-warning" :
                                             r.Status == GeneralClass.Approved ? "btn-success" : "btn-secondary";
                                        }
                                        <td class="text-left"> <span class="btn @status btn-sm">  @r.Status </span> </td>
                                    </tr>

                                    <tr>
                                        <td class="">Volume (bopd)</td>
                                        <td class="text-left">@r.Volume </td>
                                    </tr>

                                    <tr>
                                        <td class="">Contractor Name</td>
                                        <td class="text-left">@r.ContractorName </td>
                                    </tr>

                                    <tr>
                                        <td class="">Rig Name</td>
                                        <td class="text-left">@r.RigName </td>
                                    </tr>

                                    <tr>
                                        <td class="">Rig Type</td>
                                        <td class="text-left">@r.RigType </td>
                                    </tr>

                                    <tr>
                                        <td>Date Applied</td>
                                        <td class="text-left"><b>@r.DateApplied</b></td>
                                    </tr>

                                    <tr>
                                        <td>Date Submitted</td>
                                        <td class="text-left"><b>@r.DateSubmitted</b></td>
                                    </tr>

                                    <tr>
                                        <td>Payment RRR</td>
                                        <td class="text-left text-info"><b>@r.RRR</b></td>
                                    </tr>
                                    <tr>
                                        <td>Transaction Type</td>
                                        <td class="text-left text-danger"><b>@r.TransType</b></td>
                                    </tr>

                                    <tr>
                                        <td> Amount Paid </td>
                                        <td class="text-left"> <span> @symbol@string.Format("{0:N}", r.AmountPaid) </span> </td>
                                    </tr>
                                    <tr>
                                        <td> Service Charge </td>
                                        <td class="text-left"> <span> @symbol@string.Format("{0:N}", r.ServiceCharge) </span> </td>
                                    </tr>
                                    <tr>
                                        <td> Total Amount </td>
                                        <td class="text-left">
                                            <span>

                                                @{
                                                    var totalAmount = r.TotalAmount;
                                                }

                                                @symbol@string.Format("{0:N}", totalAmount)

                                            </span>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td> Trans. Description </td>
                                        <td class="text-left"> <small class="">  @r.TransDescription </small> </td>
                                    </tr>

                                    <tr>
                                        <td> Trans. Status </td>
                                        <td class="text-left"> <b class="">  @r.TransStatus </b> </td>
                                    </tr>

                                    <tr>
                                        <td>Documents Attached</td>

                                        <td class="text-left">
                                            @foreach (var appDoc in apps.appDocuuments)
                                            {
                                                var addictional = appDoc.isAddictional == true ? "(Additional Document)" : "";

                                                <a href="@appDoc.DocSource" target="_blank" style="color:darkslategrey; font-size:smaller">
                                                    <div class="" style="border:1px solid #dadada; padding:10px; margin:2px; cursor:pointer" title="Click to view document">

                                                        <i class="fas fa-file-alt fa-lg text-info"> </i>&nbsp;

                                                        <b> @appDoc.DocName  </b>
                                                        <br />
                                                        <b class="text-danger"> @addictional </b>
                                                    </div>
                                                </a>
                                            }
                                        </td>
                                    </tr>

                                </tbody>
                            </table>

                        </div>

                    </div>



                    <div class="col-sm-4">

                        <div>

                            <div class="card-black">
                                <h4> <b>Current Desk</b> </h4>
                                <hr />

                                @if (Model.FirstOrDefault().applications.FirstOrDefault().Status != GeneralClass.Processing)
                                {
                                    <b class="text-primary"> COMPANY </b>
                                }
                                else
                                {<b class="text-primary"> @Model.FirstOrDefault().currentDesks.FirstOrDefault().Staff </b>
                            }
                            </div>


                            <br />


                            @{
                                var commentList = apps.histories.Where(x => x.Comment.Contains("=>"));
                                var lastComment = commentList.Count() <= 0 ? "" : commentList.FirstOrDefault().Comment;

                                var backgroundC = "";
                            }

                            @if (r.Status == GeneralClass.Rejected)
                            {
                                backgroundC = "background-color:lightcoral; padding:10px; color:white; line-height:30px";
                            }
                            else if (r.Status == GeneralClass.Approved)
                            {
                                backgroundC = "background-color:mediumseagreen;padding:10px; color:white; line-height:30px";
                            }
                            else
                            {
                                backgroundC = "background-color:darkslateblue;padding:10px; color:white; line-height:30px";
                            }



                            <div class="card-black ">
                                <h4> <b>Last Comment</b> </h4>
                                <hr />

                                <div style="@backgroundC">

                                    <b> @lastComment</b>

                                </div>
                            </div>


                            <br />


                            <div class="table-responsive card-black">
                                <h4 class=""><b>Last 3 Application History</b></h4>

                                <table class="table table-bordered table-striped">
                                    <caption> <a href="/Applications/ApplicationHistory/@generalClass.Encrypt(r.AppId.ToString())" class="text-primary" target="_blank" title="Click to view application history"> See more </a> </caption>
                                    <thead>

                                        <tr class="">
                                            <td>Date</td>
                                            <td>Comment</td>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        @foreach (var his in apps.histories)
                                        {
                                            <tr>
                                                <td> @his.HistoryDate  </td>
                                                <td class="text-left"> <small>Action From : @his.ActionFrom  - - </small> <b style="color:saddlebrown"> @his.Comment </b>  <small>. - - Action To : @his.ActionTo</small></td>
                                            </tr>
                                        }
                                    </tbody>
                                </table>
                            </div>

                            <br />


                            <div class="card-black">

                                <h4> <b>Application Reports </b></h4>

                                <hr />

                                <div id="divReport">
                                    @foreach (var appReport in apps.appReports)
                                    {
                                        <div style="margin-top:10px; padding:10px; border:1px solid #d7d4d4">

                                            <p class=""><b>@appReport.Subject</b></p>
                                            <hr />

                                            <p class="text-danger"> <a href="/Applications/ViewReport/@generalClass.Encrypt(appReport.ReportID.ToString())" target="_blank"><b>Click to view @appReport.Staff report </b></a></p>

                                            <p> <b class="">Created At : </b> @appReport.CreatedAt</p>

                                            @if (appReport.StaffID == Convert.ToInt32(generalClass.Decrypt(Context.Session.GetString(AuthController.sessionUserID)))) // change to staff session id
                                            {
                                                <p> <button class="btn btn-sm btn-info" onclick="GetReport('@generalClass.Encrypt(appReport.ReportID.ToString())')" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AppEditReportModal"> <i class="fa fa-pen"> </i> Edit </button> &nbsp; <button class="btn btn-sm btn-googleplus" onclick="DeleteReport('@generalClass.Encrypt(appReport.ReportID.ToString())')">  <i class="fa fa-trash"> </i> Bin </button></p>
                                            }
                                        </div>
                                        <hr />
                                    }
                                </div>

                            </div>



                        </div>

                    </div>


                    <div class="col-sm-3">

                        @if (apps.applicationProccesses.Any())
                        {
                            <div class="card-black">

                                @foreach (var opt in apps.applicationProccesses)
                                {
                                    <input type="text" hidden id="txtProcessID" value="@generalClass.Encrypt(opt.ProccessId.ToString())" />

                                    <h4> Operations Controls </h4>
                                    <hr />
                                    @if (opt.CanPush == true)
                                    {
                                        <button type="button" id="btnSinglePush" class="btn btn-primary btn-block" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#">
                                            Distribute Applications
                                        </button>

                                        <button type="button" hidden id="btnPushSingleApp" class="btn btn-primary pull-right" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#InsPushAppModal">
                                            Click
                                        </button>
                                        <p></p>
                                    }

                                    if (opt.CanWork == true)
                                    {
                                        if (opt.CanReport == true)
                                        {
                                            <button class="btn btn-warning btn-block" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AppReportModal"> Add Report </button>
                                            <p></p>
                                        }

                                        if (opt.CanSchdule == true)
                                        {
                                            <button class="btn btn-info btn-block" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AppSchduleModal"> Schedule Meeting </button>
                                            <p></p>

                                            if (generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.SECTION_HEAD && apps.applications.FirstOrDefault().ProposalApproved == "NO")
                                            {
                                                <button class="btn btn-facebook btn-block" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AddStaffModal"> Send Nomination Request </button>
                                                <p></p>
                                            }
                                        }

                                        if (opt.CanInspect == true)
                                        {
                                            <a class="btn btn-facebook btn-block" href="#" target="_blank"> <b> Fill Form </b> </a>
                                            <p></p>
                                        }

                                        if (opt.CanAccept == true)
                                        {
                                            <button class="btn btn-success btn-block" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AppApproveModal"> @buttonName </button>
                                            <p></p>
                                        }


                                        if (opt.CanReject == true)
                                        {
                                            <button class="btn btn-danger btn-block" id="btnExternalRejectionModal" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AppExternalRejectionModals"> Send Back </button>
                                            <p></p>

                                            if ((generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.HEAD_UMR || generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.AD_UMR) && apps.applications.FirstOrDefault().ProposalApproved == "NO")
                                            {
                                                <button class="btn btn-danger btn-block" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AddDisapproveModal"> Disapprove </button>
                                                <p></p>
                                            }
                                        }
                                    }
                                }

                            </div>
                        }


                        <br />

                        <div class="card-black">

                            <h4> <b>Nomination Request</b> </h4>

                            <hr />

                            <div id="divNominatedStaff">
                                @foreach (var n in apps.NominationRequest.ToList())
                                {
                                    <div style="margin-top:10px;">

                                        <p class="text-info"> <b> Sent To : @n.Staff </b></p>
                                        <p class="text-danger"> <b>Nomination done - @n.hasDone</b></p>
                                        <p><b> Comment :</b> <small>@n.Comment</small></p>
                                        <hr />
                                        <p> Created At : @n.CreatedAt</p>
                                        <p> Reminded At : @n.ReminderedAt</p>
                                        <p> Update At : @n.UpdatedAt</p>
                                    </div>
                                }
                            </div>

                        </div>

                        <br />


                        <div class="card-black">

                            <h4> <b>Nominated Staff</b> </h4>

                            <hr />

                            <div id="divNominatedStaff">
                                @foreach (var n in apps.nominations)
                                {
                                    var nominationid = generalClass.Encrypt(n.NominationID.ToString());

                                    <div style="margin-top:10px;">

                                        <p class="text-info"> <small><b> @n.StaffName - @n.UserRoles </b></small> - <a href="/Applications/ViewNominationReport/@nominationid" class="btn btn-outline-warning btn-xs"> View Report</a></p>

                                        @if (apps.applications.FirstOrDefault().Status == GeneralClass.Approved)
                                        {
                                            <a class="btn btn-facebook btn-sm" href="/Permits/ViewLetter/@generalClass.Encrypt(n.AppId.ToString())/_view" target="_blank"> <i class="ti-files"> </i> View Letter </a>
                                        }
                                    </div>
                                    <hr />
                                }
                            </div>

                        </div>


                        <br />

                        <div id="divSchdules">
                            

                            <div class="card-black ">

                                <h4 class=""> <b>Schedule(s)</b> </h4>
                                <hr />

                                @foreach (var appSchdule in apps.appSchdules)
                                {
                                    var startDate = DateTime.Parse(appSchdule.CreatedAt);
                                    var expDate = startDate.AddDays(3);

                                    <div id="divSchdule">

                                        <div style="border:1px solid #dadada; padding:10px; margin-top:10px;">

                                            <small>
                                                <p> By : <b>@appSchdule.SchduleByEmail</b></p>
                                                <p> Type : <b>@appSchdule.SchduleType</b></p>
                                                <p> Location : <b>@appSchdule.SchduleLocation</b></p>
                                                <p> Schedule Date : <b class="text-danger">@appSchdule.SchduleDate</b></p>
                                                <p> Comment : <b class="text-success">@appSchdule.SchduleComment</b></p>

                                                @if (DateTime.Now > expDate)
                                                {
                                                    <p> Expired Status:<b class="text-danger"> Expired </b></p>
                                                }
                                                else
                                                {
                                                    <p> Expired Status: <b>Still Valid</b></p>
                                                }

                                                <p> Manger Response : <b class="text-primary">@appSchdule.sResponse</b></p>
                                                <p> Manger Comment : <b class="text-success">@appSchdule.SupervisorComment</b></p>
                                                <p> Company Response : <b class="text-primary">@appSchdule.cResponse</b></p>
                                                <p> Company Comment : <b class="text-warning">@appSchdule.CustomerComment</b></p>

                                                <hr />
                                                <p> Created At : @appSchdule.CreatedAt</p>
                                                <p> Updated At : @appSchdule.UpdatedAt</p>

                                            </small>

                                            <br />


                                            @if (DateTime.Now > expDate)
                                            {
                                                <b class="text-danger"> Schdule has expired </b>
                                            }
                                            else
                                            {
                                                @if (appSchdule.SchduleByID == Convert.ToInt32(generalClass.Decrypt(Context.Session.GetString(AuthController.sessionUserID)))@*|| generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.SECTION_HEAD*@)
                                            {
                                            if (appSchdule.cResponse == GeneralClass.Rejected || appSchdule.sResponse == GeneralClass.Rejected)
                                            {
                                                <button class="btn btn-sm btn-info" onclick="GetSchdule('@generalClass.Encrypt(appSchdule.SchduleID.ToString())')" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AppEditSchduleModal"> <i class="fas fa-pencil-alt"> </i> Reschedule </button>
                                            }
                                            else
                                            {
                                                <button class="btn btn-sm btn-info" onclick="GetSchdule('@generalClass.Encrypt(appSchdule.SchduleID.ToString())')" data-toggle="modal" data-backdrop="static" data-keyboard="false" data-target="#AppEditSchduleModal"> <i class="fas fa-pencil-alt"> </i> Edit </button>
                                            }
                                            <span> &nbsp; <button class="btn btn-sm btn-googleplus" onclick="DeleteSchdule('@generalClass.Encrypt(appSchdule.SchduleID.ToString())')">  <i class="fa fa-trash"> </i> Bin </button> </span>
                                        }
                                    }
                                    </div>
                                </div>
                            }
                            </div>
                        </div>
                    </div>
                </div>
                <p><br /></p>
            </div>
        }
    }
</div>


@* Distribute application to staff *@
<div class="modal" id="InsPushAppModal">

    <div class="modal-dialog modal-lg">
        <div class="modal-content">

            @{
                string Role = "";

                    @if (generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.AD_UMR)
                {
                    Role = GeneralClass.SECTION_HEAD;
                }
                else
                {
                    Role = GeneralClass.TEAM;
                }
            }

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Select one <b class="text-danger">@Role</b> to distribute application to</h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <!-- Modal body -->
            <div class="modal-body">


                <div>
                    <p class="text-primary"> Enter some comment below </p>
                    <textarea id="txtPushComment" style="max-width:100%" rows="5" cols="68" class="form-control rounded-0" placeholder="Some comment here..."></textarea>
                </div>

                <p></p>

                <div class="table-responsive" id="DivDistributAppsLoader">

                    <table class="table table-bordered table-hover table-striped" style="" id="DivDistributApps">
                        <thead>
                            <tr>
                                <th>Last Name</th>
                                <th>First Name</th>
                                <th>Email</th>
                                <th>Desk Count</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>

                </div>

            </div>


            <!-- Modal footer -->
            <div class="modal-footer">

                <div id="InsAppDropInfo" class="text-danger">

                </div>

            </div>

        </div>
    </div>

</div>

@* Add a staff to carry out designation *@
<div class="modal" id="AddStaffModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content card-black" id="AddStaffLoader">
            <div class="modal-header">
                <h4 class="modal-title"> Send Nomination Request </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div class="form-group">
                    <label for="comment">Select Staff</label>

                    @*<input type="text" list="staffNominationList" placeholder="Search for name here..." name="txtNominatedStaff" id="txtNominatedStaff" class="form-control" required />

                    <datalist id="staffNominationList">
                        @foreach (var apps in Model)
                        {
                            if (apps.staffs.Any())
                            {
                                foreach (var s in apps.staffs)
                                {
                                    <option value="@s.FullName | @s.FieldOffice | @s.StaffEmail">@s.FullName (@s.FieldOffice - @s.RoleName)</option>
                                }
                            }
                            else
                            {
                                <option value="Empty User">Empty user </option>
                            }
                        }
                    </datalist>*@
                    <select name="txtNominatedStaff" id="txtNominatedStaff" style="width: 100%;" class="form-control stafflist" required multiple>
                        @foreach (var apps in Model)
                        {
                            if (apps.staffs.Any())
                            {
                                foreach (var s in apps.staffs)
                                {
                                    <option value="@s.StaffId">@s.FullName (@s.FieldOffice - @s.RoleName)</option>
                                }
                            }
                            else
                            {
                                <option value="Empty User">Empty user </option>
                            }
                        }
                    </select>
                </div>

                <div class="form-group">
                    <label for="comment"> Comment:</label>
                    <br />
                    <textarea class="btn-block" id="txtRequestComment" style="max-width:100%" rows="4" cols="60" placeholder="Some comment here...Max(100)"></textarea>
                </div>

                <button class="btn btn-facebook" id="btnSendNominationRequest"> Send Request </button>
                <p></p>
                <div id="AddStaffModalInfo" class=""> </div>

            </div>

        </div>
    </div>
</div>

@* Rejection *@
<div class="modal" id="AppExternalRejectionModals">
    <div class="modal-dialog modal-lg">
        <div class="modal-content card-black" id="AppExternalRejectionLoadder">
            <div class="modal-header">
                <h4 class="modal-title"> Reject Application Back </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div class="row">


                    @{
                        var divclass = "";
                        var hide = "";
                    }

                    @if (generalClass.Decrypt(Context.Session.GetString(AuthController.sessionRoleName)) == GeneralClass.TEAM)
                    {
                        hide = "";
                        divclass = "col-sm-6";
                    }
                    else
                    {
                        hide = "hide";
                        divclass = "col-sm-12";
                    }

                    <div class="@divclass @hide">
                        <b> Select Other Document(s) </b>
                        <div class="table-responsive" style="max-height:500px; overflow-y:scroll">
                            <table class="table table-bordered table-hover" style="font-size:smaller" id="OtherDocsTable">
                                <thead>
                                    <tr>
                                        <th style="padding-left: 18px;">Select</th>
                                        <th class="text-left"><b> Select Additional Document(s) for this application</b> </th>
                                    </tr>
                                </thead>
                                <tbody>
                                    @foreach (var apps in Model)
                                    {
                                        foreach (var otherDoc in apps.otherDocuments)
                                        {
                                            <tr>
                                                <td> @otherDoc.LocalDocID </td>
                                                <td class="text-left"> @otherDoc.DocName</td>
                                            </tr>
                                        }
                                    }
                                </tbody>
                            </table>
                        </div>

                    </div>


                    <div class="@divclass">
                        <div>
                            @foreach (var apps in Model)
                            {
                                foreach (var appDetail in apps.applications)
                                {

                                    <div style="font-size:9px" >
                                        <div>
                                            <h5>Reference NO :<b class="text-primary"> @appDetail.RefNo</b></h5>
                                        </div>

                                        <hr />
                                        <div>
                                            <h5>Company Name : <b>@appDetail.CompanyName </b></h5>
                                        </div>
                                        <p></p>
                                        <div>
                                            <h5>Company Address : @appDetail.CompanyAddress </h5>
                                        </div>
                                        <p></p>
                                        <div>
                                            <h5>Email : @appDetail.CompanyEmail</h5>
                                        </div>
                                        <hr />
                                        <div>
                                            <h5>Stage : <small><b>@appDetail.Stage</b></small></h5>
                                        </div>
                                        <p></p>
                                        <div>
                                            <h5 class="text-primary">Application : <b>@appDetail.Status</b> </h5>
                                        </div>
                                        <p></p>
                                        <div>
                                            <h5>Date Applied : @appDetail.DateApplied </h5>
                                        </div>
                                        <p></p>
                                        <div>
                                            <h5>Date Submitted : @appDetail.DateSubmitted </h5>
                                        </div>
                                    </div>

                                }
                            }
                            <hr />

                        </div>

                        <div class="form-group">
                            <label for="comment"> Comment:</label>
                            <br />
                            <textarea class="btn-block" id="txtAppExRejectComment" style="max-width:100%" rows="4" cols="60" placeholder="Some comment here...Max(100)"></textarea>
                        </div>

                        <hr />

                        <button class="btn btn-danger" id="btnReject"> Send Back </button>

                    </div>

                </div>

                <p></p>
                <div id="ExRejectModalInfo"> </div>

            </div>

        </div>
    </div>
</div>

@* Approval div *@
<div class="modal" id="AppApproveModal">
    <div class="modal-dialog modal-md">
        <div class="modal-content card-black" id="AppApproveLoadder">
            <div class="modal-header">
                <h4 class="modal-title"> Application Approval  </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div>
                    @foreach (var apps in Model)
                    {
                        foreach (var appDetail in apps.applications)
                        {

                            <div class="alert">
                                <div>
                                    <h5>Reference NO :<b class="text-primary"> @appDetail.RefNo</b></h5>
                                </div>
                                <p></p>

                                <hr />
                                <div>
                                    <h5>Company Name : <b>@appDetail.CompanyName </b></h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Company Address : @appDetail.CompanyAddress </h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Email : @appDetail.CompanyEmail</h5>
                                </div>
                                <hr />
                                <div>
                                    <h5>Stage : <small><b>@appDetail.Stage</b></small></h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5 class="text-primary">Application : <b>@appDetail.Status</b> </h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Date Applied : @appDetail.DateApplied </h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Date Submitted : @appDetail.DateSubmitted </h5>
                                </div>
                            </div>

                        }
                    }
                    <hr />

                </div>
                @if(!Model.FirstOrDefault().applications.FirstOrDefault().ShortName.Contains("MER"))
                {
                    <div class="form-group">
                        <label for="comment"> Enter Proposed Volume (bopd):</label>
                        <br />
                        <input type="number" step="any" id="txtVolume" class="form-control" placeholder="Enter Proposed Volume here (bopd)"/>
                    </div>                    
                }

                <div class="form-group">
                    <label for="comment"> Comment:</label>
                    <br />
                    <textarea id="txtAppApproveComment" class="btn-block" style="max-width:100%" rows="5" cols="68" placeholder="Some comment here...Max(100)"></textarea>
                </div>

                <button class="btn btn-primary" id="btnApprove"> @buttonName </button> &nbsp;

                <p></p>
                <div id="ApproveModalInfo"> </div>

            </div>

        </div>
    </div>
</div>

@* Disapprove div *@
<div class="modal" id="AddDisapproveModal">
    <div class="modal-dialog modal-md">
        <div class="modal-content card-black" id="AppDisapproveLoadder">
            <div class="modal-header">
                <h4 class="modal-title">Disapprove Application  </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div>
                    @foreach (var apps in Model)
                    {
                        foreach (var appDetail in apps.applications)
                        {

                            <div class="alert">
                                <div>
                                    <h5>Reference NO :<b class="text-primary"> @appDetail.RefNo</b></h5>
                                </div>
                                <p></p>

                                <hr />
                                <div>
                                    <h5>Company Name : <b>@appDetail.CompanyName </b></h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Company Address : @appDetail.CompanyAddress </h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Email : @appDetail.CompanyEmail</h5>
                                </div>
                                <hr />
                                <div>
                                    <h5>Stage : <b>@appDetail.Stage</b></h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5 class="text-primary">Application : <b>@appDetail.Status</b> </h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Date Applied : @appDetail.DateApplied </h5>
                                </div>
                                <p></p>
                                <div>
                                    <h5>Date Submitted : @appDetail.DateSubmitted </h5>
                                </div>
                            </div>

                        }
                    }
                    <hr />

                </div>

                <div class="form-group">
                    <label for="comment"> Comment:</label>
                    <br />
                    <textarea id="txtAppDisApproveComment" class="btn-block" style="max-width:100%" rows="5" cols="68" placeholder="Some comment here...Max(100)"></textarea>
                </div>

                <button class="btn btn-danger" id="btnDisApprove"> Disapprove </button> &nbsp;

                <p></p>
                <div id="DisApproveModalInfo"> </div>

            </div>

        </div>
    </div>
</div>

@* creating an applicatioin report *@
<div class="modal" id="AppReportModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content card-black" id="AppReportLoader">
            <div class="modal-header">
                <h4 class="modal-title"><b> Add a report to this application</b> </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div>

                    <div>

                        <div class="text-left">

                            <ul style="font-size:smaller; line-height:20px" class="">
                                <li>
                                    1) .Please note. All documents listed below are required and must be uploaded. Subsequently, other documents may been needed and will be added to this list.
                                </li>
                                <li>
                                    2). The MAX file size allowed is 4MB per document. Any file greated than this will not be uploaded.
                                </li>
                                <li>
                                    3). Only JPEG, PNG, JPG, and PDF file types are allowed on this platform.
                                </li>
                            </ul>

                        </div>

                        <br />

                        <div class="table-responsive">

                            <input type="text" hidden id="FacilityElpsID" name="FacilityElpsID" value="@ViewData["FacilityElpsID"]" />
                            <input type="text" hidden id="txtCompanyElpsID" name="txtCompanyElpsID" value="@ViewData["CompanyElpsID"]" />
                            <input type="text" hidden id="txtURL" name="txtURL" value="@ElpsServices._elpsBaseUrl" />
                            <input type="text" hidden id="txtHash" name="txtHash" value="@ElpsServices.appHash" />
                            <input type="text" hidden id="txtElpsEmail" name="txtHash" value="@ElpsServices._elpsAppEmail" />

                            <table class="table table-hover" style="font-size:small" id="docTable">
                                <thead>
                                    <tr style="font-weight:bolder;">

                                        <th> Source</th>`
                                        <th> Type Name</th>
                                        @*<th> Avialable </th>*@
                                        <th> Change </th>
                                    </tr>
                                </thead>

                                <tbody>

                                    @foreach (var bothDoc in Model.FirstOrDefault().bothDocuments)
                                    {
                                        foreach (var presentDoc in bothDoc.presentDocuments)
                                        {
                                            var present = presentDoc.Present == true ? "Uploaded" : "Not Uploaded";

                                            var file_icon = "";
                                            var font_png_icon = "fa-file-image";
                                            var font_pdf_icon = "fa-file-pdf text-danger";

                                            var font_file_icon = "fa-file text-info";

                                            var img_link = /*"elpsdemo.dpr.gov.ng" +*/ presentDoc.Source;

                                            file_icon = presentDoc.Source.EndsWith(".png") == true ? font_png_icon :
                                                   presentDoc.Source.EndsWith(".PNG") == true ? font_png_icon :
                                                   presentDoc.Source.EndsWith(".jpg") == true ? font_png_icon :
                                                   presentDoc.Source.EndsWith(".JPG") == true ? font_png_icon :
                                                   presentDoc.Source.EndsWith(".jpeg") == true ? font_png_icon :
                                                   presentDoc.Source.EndsWith(".JPEG") == true ? font_png_icon :
                                                   presentDoc.Source.EndsWith(".pdf") == true ? font_pdf_icon :
                                                   presentDoc.Source.EndsWith(".PDF") == true ? font_pdf_icon : font_file_icon;

                                            <tr class="" id="docRowE_@presentDoc.LocalDocID">

                                                <td class="text-center">


                                                    <input type="text" hidden name="txtELocalDocID[]" value="@presentDoc.LocalDocID" required />
                                                    <input type="text" hidden name="txtECompDocElpsID[]" id="doc_@presentDoc.LocalDocID" value="@presentDoc.CompElpsDocID" required />
                                                    <input type="text" hidden id="docEType_@presentDoc.LocalDocID" value="@presentDoc.DocType" required />
                                                    <input type="text" hidden name="txtEDocSource[]" id="docSource_@presentDoc.LocalDocID" value="@presentDoc.Source" required />



                                                    <a href="@img_link" target="_blank" style="color:black" class="imgLink" title="Click to view document">
                                                        <i class="fa @file_icon fa-2x"></i>
                                                    </a>
                                                    <br />
                                                    <small class="text-info"><b> View Doc </b></small>
                                                    <br />

                                                    @*<button class="btn btn-xs btn-danger" type="button" onclick="DeleteDocument(@presentDoc.CompElpsDocID, @presentDoc.LocalDocID, '@presentDoc.DocType')"> <i class="fa fa-trash"> </i> Delete Doc </button>*@
                                                </td>

                                                <td style="font-size:smaller">
                                                    @presentDoc.TypeName
                                                    <div id="ErrorE_@presentDoc.LocalDocID">

                                                    </div>
                                                    <div id="progressE_@presentDoc.LocalDocID" class="progress" style="height: 10px;">
                                                        <div class="progress-bar progress-bar-primary" role="progressbar"></div>
                                                    </div>
                                                </td>


                                                @*<td style="color:black"><b>@present</b></td>*@
                                                <td>
                                                    <button type="button" class="btn btn-primary btn-sm" onclick="updateBrowse(@presentDoc.LocalDocID)"> <i class="fa fa-cloud-upload-alt"> </i> Add Doc </button>
                                                    <input type="file" hidden class="updatefile" id="UpdateE_@presentDoc.LocalDocID" onclick="updateFile(this, @presentDoc.LocalDocID);" name="Upload" accept="image/jpg,image/png,image/jpeg,application/pdf" />
                                                </td>

                                            </tr>
                                        }



                                        foreach (var missingDoc in bothDoc.missingDocuments)
                                        {
                                            var present = missingDoc.Present == true ? "Uploaded" : "Not Uploaded";

                                            <tr style="font-weight:bold" id="docRow2_@missingDoc.LocalDocID">


                                                <td class="text-center">


                                                    <input type="text" hidden value="@missingDoc.LocalDocID" required />
                                                    <input type="text" hidden name="missingCompElpsDocID[]" value="@missingDoc.CompElpsDocID" required />
                                                    <input type="text" hidden id="docType_@missingDoc.LocalDocID" value="@missingDoc.DocType" required />
                                                    <input type="text" hidden id="docTypeID_@missingDoc.LocalDocID" value="@missingDoc.DocTypeID" required />


                                                    <i class="fa fa-exclamation-triangle fa-2x text-warning"></i>
                                                </td>

                                                <td style="font-size:smaller">
                                                    @missingDoc.TypeName
                                                    <div id="Error2_@missingDoc.LocalDocID"> </div>
                                                    <div id="progress2_@missingDoc.LocalDocID" class="progress" style="height: 10px;">
                                                        <div class="progress-bar progress-bar-primary" role="progressbar"></div>
                                                    </div>
                                                </td>
                                                @*<td class="text-danger">@present</td>*@
                                                <td>
                                                    <button type="button" class="btn btn-primary btn-sm m-b-10 m-l-5" onclick="OpenUploadBrowse(@missingDoc.LocalDocID)"> <i class="fa fa-cloud-upload-alt"> </i> Add Doc </button>
                                                    <input type="file" hidden class="uploadfile" id="Upload_@missingDoc.LocalDocID" onclick="uploadFile(this, @missingDoc.LocalDocID);" name="Upload" accept="image/jpg,image/png,image/jpeg,application/pdf" />
                                                </td>

                                            </tr>
                                        }
                                    }

                                </tbody>
                            </table>
                        </div>


                    </div>

                    <hr />


                    <div class="form-group">
                        <label for="title">Title:</label>
                        <br />
                        <input id="txtReportTitle" class="form-control" required placeholder="Enter Report Title here" />
                    </div>

                    <div class="form-group">
                        <label for="comment">Comment:</label>
                        <br />
                        <textarea id="txtAppReport" required style="max-width:100%" rows="7" cols="168" placeholder="Some report here..."></textarea>
                    </div>

                    <button class="btn btn-facebook" id="btnSaveReport"> Send Report </button>
                    <p></p>
                    <div id="ReportModalInfo" class="text-danger"> </div>

                </div>
            </div>

        </div>
    </div>
</div>



@* Editing an applicatioin report *@
<div class="modal" id="AppEditReportModal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content card-black" id="AppEditReportLoadder">
            <div class="modal-header">
                <h4 class="modal-title"> Edit this application report </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div>

                    <div class="text-left">

                        <ul style="font-size:smaller; line-height:20px" class="">
                            <li>
                                1) .Please note. All documents listed below are required and must be uploaded. Subsequently, other documents may been needed and will be added to this list.
                            </li>
                            <li>
                                2). The MAX file size allowed is 4MB per document. Any file greated than this will not be uploaded.
                            </li>
                            <li>
                                3). Only JPEG, PNG, JPG, and PDF file types are allowed on this platform.
                            </li>
                        </ul>

                    </div>

                    <br />

                    <div class="table-responsive">

                        <input type="text" hidden id="FacilityElpsID" name="FacilityElpsID" value="@ViewData["FacilityElpsID"]" />
                        <input type="text" hidden id="txtCompanyElpsID" name="txtCompanyElpsID" value="@ViewData["CompanyElpsID"]" />
                        <input type="text" hidden id="txtURL" name="txtURL" value="@ElpsServices._elpsBaseUrl" />
                        <input type="text" hidden id="txtHash" name="txtHash" value="@ElpsServices.appHash" />
                        <input type="text" hidden id="txtElpsEmail" name="txtHash" value="@ElpsServices._elpsAppEmail" />

                        <table class="table table-hover" style="font-size:small" id="docTable2">
                            <thead>
                                <tr style="font-weight:bolder;">

                                    <th> Source</th>`
                                    <th> Type Name</th>
                                    @*<th> Avialable </th>*@
                                    <th> Change </th>
                                </tr>
                            </thead>

                            <tbody>

                                @foreach (var bothDoc in Model.FirstOrDefault().bothDocuments)
                                {
                                    foreach (var presentDoc in bothDoc.presentDocuments)
                                    {
                                        var present = presentDoc.Present == true ? "Uploaded" : "Not Uploaded";

                                        var file_icon = "";
                                        var font_png_icon = "fa-file-image";
                                        var font_pdf_icon = "fa-file-pdf text-danger";

                                        var font_file_icon = "fa-file text-info";

                                        var img_link = /*"elpsdemo.dpr.gov.ng" +*/ presentDoc.Source;

                                        file_icon = presentDoc.Source.EndsWith(".png") == true ? font_png_icon :
                                               presentDoc.Source.EndsWith(".PNG") == true ? font_png_icon :
                                               presentDoc.Source.EndsWith(".jpg") == true ? font_png_icon :
                                               presentDoc.Source.EndsWith(".JPG") == true ? font_png_icon :
                                               presentDoc.Source.EndsWith(".jpeg") == true ? font_png_icon :
                                               presentDoc.Source.EndsWith(".JPEG") == true ? font_png_icon :
                                               presentDoc.Source.EndsWith(".pdf") == true ? font_pdf_icon :
                                               presentDoc.Source.EndsWith(".PDF") == true ? font_pdf_icon : font_file_icon;

                                        <tr class="" id="docRowE_@presentDoc.LocalDocID">

                                            <td class="text-center">


                                                <input type="text" hidden name="txtELocalDocID[]" value="@presentDoc.LocalDocID" required />
                                                <input type="text" hidden name="txtECompDocElpsID[]" id="docE_@presentDoc.LocalDocID" value="@presentDoc.CompElpsDocID" required />
                                                <input type="text" hidden id="docEType_@presentDoc.LocalDocID" value="@presentDoc.DocType" required />
                                                <input type="text" hidden  name="txtEDocSource[]" id="docSourceE_@presentDoc.LocalDocID" value="@presentDoc.Source" required />



                                                <a href="@img_link" target="_blank" style="color:black" title="Click to view document">
                                                    <i class="fa @file_icon fa-2x"></i>
                                                </a>
                                                <br />
                                                <small class="text-info"><b> View Doc </b></small>
                                                <br />

                                                @*<button class="btn btn-xs btn-danger" type="button" onclick="DeleteDocument(@presentDoc.CompElpsDocID, @presentDoc.LocalDocID, '@presentDoc.DocType')"> <i class="fa fa-trash"> </i> Delete Doc </button>*@
                                            </td>

                                            <td style="font-size:smaller">
                                                @presentDoc.TypeName
                                                <div id="ErrorE_@presentDoc.LocalDocID">

                                                </div>
                                                <div id="progressE_@presentDoc.LocalDocID" class="progress" style="height: 10px;">
                                                    <div class="progress-bar progress-bar-primary" role="progressbar"></div>
                                                </div>
                                            </td>


                                            @*<td style="color:black"><b>@present</b></td>*@
                                            <td>
                                                <button type="button" class="btn btn-primary btn-sm" onclick="updateBrowse(@presentDoc.LocalDocID)"> <i class="fa fa-cloud-upload-alt"> </i> Add Doc </button>
                                                <input type="file" hidden class="updatefile" id="UpdateE_@presentDoc.LocalDocID" onclick="updateFile(this, @presentDoc.LocalDocID);" name="Upload" accept="image/jpg,image/png,image/jpeg,application/pdf" />
                                            </td>

                                        </tr>
                                    }



                                    foreach (var missingDoc in bothDoc.missingDocuments)
                                    {
                                        var present = missingDoc.Present == true ? "Uploaded" : "Not Uploaded";

                                        <tr style="font-weight:bold" id="docRow2_@missingDoc.LocalDocID">


                                            <td class="text-center">


                                                <input type="text" hidden value="@missingDoc.LocalDocID" required />
                                                <input type="text" hidden name="missingCompElpsDocID[]" value="@missingDoc.CompElpsDocID" required />
                                                <input type="text" hidden id="docType_@missingDoc.LocalDocID" value="@missingDoc.DocType" required />
                                                <input type="text" hidden id="docTypeID_@missingDoc.LocalDocID" value="@missingDoc.DocTypeID" required />


                                                <i class="fa fa-exclamation-triangle fa-2x text-warning"></i>
                                            </td>

                                            <td style="font-size:smaller">
                                                @missingDoc.TypeName
                                                <div id="Error2_@missingDoc.LocalDocID"> </div>
                                                <div id="progress2_@missingDoc.LocalDocID" class="progress" style="height: 10px;">
                                                    <div class="progress-bar progress-bar-primary" role="progressbar"></div>
                                                </div>
                                            </td>
                                            @*<td class="text-danger">@present</td>*@
                                            <td>
                                                <button type="button" class="btn btn-primary btn-sm m-b-10 m-l-5" onclick="OpenUploadBrowse(@missingDoc.LocalDocID)"> <i class="fa fa-cloud-upload-alt"> </i> Add Doc </button>
                                                <input type="file" hidden class="uploadfile" id="Upload_@missingDoc.LocalDocID" onclick="uploadFile(this, @missingDoc.LocalDocID);" name="Upload" accept="image/jpg,image/png,image/jpeg,application/pdf" />
                                            </td>

                                        </tr>
                                    }
                                }

                            </tbody>
                        </table>
                    </div>


                </div>

                <hr />


                <div class="form-group">
                    <label for="title">Title:</label>
                    <br />
                    <input id="txtEditReportTitle" class="form-control" required placeholder="Enter Report Title here" />
                </div>


                <div class="form-group">
                    <input id="txtEditReportID" value="" hidden />
                    <label for="comment">Comment:</label>
                    <br />
                    <textarea id="txtEditAppReport" style="max-width:100%" rows="8" cols="168" placeholder="Some report here...Max(100)"></textarea>
                </div>

                <button class="btn btn-info" id="btnEditReport"><i class="fa fa-pen"> </i> Edit Report </button>
                <p></p>
                <div id="EditReportModalInfo"> </div>

            </div>

        </div>
    </div>
</div>



@* Creating application schdule *@
<div class="modal" id="AppSchduleModal">
    <div class="modal-dialog modal-md">
        <div class="modal-content card-black" id="AppSchduleLoadder">
            <div class="modal-header">
                <h4 class="modal-title"> Create a schedule </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div class="form-group">

                    <label for="comment">Schedule Type:</label>
                    <br />
                    <select class="form-control" id="txtSchduleType">
                        <option> Meeting </option>
                        <option> Presentation </option>
                        <option> Inspection </option>
                    </select>

                    <p></p>

                    <label for="comment">Select Date:</label>
                    <br />
                    <input type="text" class="form-control" id="txtSchduleDate" value="" />

                    <p></p>

                    <label for="comment">Select Location:</label>
                    <br />
                    <select class="form-control" id="txtSchduleLocation">
                        <option> Applicant Facility </option>
                        <option> NUPRC Head Office </option>
                        <option> NUPRC Field Office - Facility Location </option>
                        <option> Online (MS Teams) </option>
                    </select>

                    <p></p>

                    <label for="comment">Comment:</label>
                    <br />
                    <textarea id="txtSchduleComment" style="max-width:100%" rows="3" cols="68" placeholder="Some report here...Max(100)"></textarea>
                </div>

                <button class="btn btn-linkedin" id="btnSaveSchdule">Save Schedule</button>
                <p></p>
                <div id="SchduleModalInfo"> </div>

            </div>

        </div>
    </div>
</div>



@* Editing application schdule *@
<div class="modal" id="AppEditSchduleModal">
    <div class="modal-dialog modal-md">
        <div class="modal-content card-black" id="AppEditSchduleLoadder">
            <div class="modal-header">
                <h4 class="modal-title"> Edit this schedule </h4>

                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true" class="btn btn-danger btn-sm">Close</span>
                </button>
            </div>

            <div class="modal-body">

                <div class="form-group">

                    <input type="text" id="txtEditSchduleID" hidden />

                    <label for="comment">Schedule Type:</label>
                    <br />
                    <select class="form-control" id="txtEditSchduleType">
                        <option> Meeting </option>
                        <option> Presentation </option>
                        <option> Inspection </option>
                    </select>

                    <p></p>

                    <label for="comment">Select Date:</label>
                    <br />
                    <input type="text" class="form-control" id="txtEditSchduleDate" value="" />

                    <p></p>

                    <label for="comment">Select Location:</label>

                    <br />
                    <select class="form-control" id="txtEditSchduleLocation">
                        <option> Applicant Facility </option>
                        <option> NUPRC Head Office </option>
                        <option> NUPRC Field Office - Facility Location </option>
                        <option> Online (MS Teams) </option>
                    </select>

                    <p></p>

                    <label for="comment">Comment:</label>
                    <br />
                    <textarea id="txtEditSchduleComment" style="max-width:100%" rows="3" cols="68" placeholder="Some report here...Max(100)"></textarea>
                </div>

                <button class="btn btn-tumblr" id="btnEditSchdule"> <i class="fa fa-pencil"></i> Edit Schedule</button>

                <p></p>

                <div id="EditSchduleModalInfo"> </div>

            </div>
        </div>
    </div>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="~/js/select2.min.js"></script>
<link rel="stylesheet" href="~/css/select2.min.css" />
<script>
    $(".stafflist").select2({
         placeholder: "Search for name here..."
    });

      function OpenUploadBrowse(id) {
        $("#Upload_" + id).click();
    }


    function uploadFile(fileInput, fileID) {

        var txtUrl = $("#txtURL").val();
        var txtHash = $("#txtHash").val();
        var txtElpsEmail = $("#txtElpsEmail").val();

        $("#Error2_" + fileID).html("");
        var docTypeID = $("#docTypeID_" + fileID).val().trim();
        var docType = $("#docType_" + fileID).val().trim();
        var uploadLocation = '';

        if (docType === "Facility") {
            uploadLocation = txtUrl + 'api/Facility/UploadFile/' + docTypeID + '/@ViewData["CompanyElpsID"]' + '/@ViewData["FacilityElpsID"]' + '/'+txtElpsEmail+'/' + txtHash + '?docName=&uniqueid=';
        }
        else {
            uploadLocation = txtUrl + 'api/UploadCompanyDoc/' + docTypeID + '/@ViewData["CompanyElpsID"]' + '/'+txtElpsEmail+'/' + txtHash + '?docName=&uniqueid=';
        }


        $(".uploadfile").fileupload({
            dataType: 'json',
            url: uploadLocation,
            done: function (e, data) {

                $("#Error2_" + fileID).html("<b style='color:blue'> Uploading... Please wait.</b>");
                $("#Upload_" + fileID).val('');
                $("#Error2_" + fileID).html("<b style='color:green'> Successfully uploaded...Please wait </b>");
                $("#docTable").load(location.href + " #docTable");
            },
            fail: function (e, data) {
                $.each(data.messages, function (index, error) {
                    if (error.toLowerCase().indexOf('bytes exceed file size' > 0)) {
                        $("#Error2_" + fileID).html("");
                        $("#Error2_" + fileID).html("<span class='text-danger'> Upload file error: Max. File size (4MB) Exceeded OR Invalid file type was selected (only pdf, jpg, jpeg or png) </span>");
                        $("#Upload_" + fileID).val('');
                    }
                    else {
                        $("#Error2_" + fileID).html("");
                        $("#Error2_" + fileID).html("<span class='text-danger'> " + error + " </span>");
                        $("#Upload_" + fileID).val('');
                    }
                });
                $("#docRow2_" + fileID).removeClass("Uploadloader");

                $("#docRow2_" + fileID).removeClass("Uploadloader");
                $("#Upload_" + fileID).val('');
                var progBox = '#progress2_' + fileID + ' .progress-bar';

                $(progBox).css(
                    'width',
                    0 + '%'
                ).text("");
            },
            progressall: function (e, data) {

                $("#docRow2_" + fileID).addClass("Uploadloader");

                var progress = parseInt(data.loaded / data.total * 100, 10);

                var progBox = '#progress2_' + fileID + ' .progress-bar';

                $(progBox).css(
                    'width',
                    progress + '%'
                ).text(progress + '%');
            }

        });

    }



      function updateFile(fileInput, fileID) {

        $("#ErrorE_" + fileID).html("");
        var documentID = $("#docE_" + fileID).val();
        var docType = $("#docEType_" + fileID).val();

        var txtUrl = $("#txtURL").val();

        uploadLocation = '';

        if (docType === "Facility") {
            var uploadLocation = txtUrl + 'api/FacilityDocument/UpdateFile/' + documentID + '/@ViewData["FacilityElpsID"]' + '?docid=' + documentID;
        }
        else {

            var uploadLocation = txtUrl + 'api/CompanyDocument/UpdateFile/' + documentID + '/@ViewData["CompanyElpsID"]' + '/' + docType.toLowerCase() + '?docid=' + documentID;
        }

        $(".updatefile").fileupload({
            dataType: 'json',
            url: uploadLocation,
            done: function (e, data) {
               
                $("#UpdateE_" + fileID).val('');
                $("#docSourceE_" + fileID).val(data.result.source);
                $(".imgLink").attr('href', data.result.source);

                $("#ErrorE_" + fileID).html("<b style='color:blue'> Changing... Please wait.</b>");

                $("#ErrorE_" + fileID).html("<b style='color:green'> Successfully Updated...Please wait </b>");
                $("#docRowE_" + fileID).removeClass("Uploadloader");
            },
            fail: function (e, data) {
                $.each(data.messages, function (index, error) {
                    if (error.toLowerCase().indexOf('bytes exceed file size' > 0)) {
                        $("#ErrorE_" + fileID).html("");
                        $("#ErrorE_" + fileID).html("<span class='text-danger'> Upload file error: Max. File size (4MB) Exceeded OR Invalid file type was selected (only pdf, jpg, jpeg or png) </span>");
                        $("#UpdateE_" + fileID).val('');
                    }
                    else {
                        $("#ErrorE_" + fileID).html("");
                        $("#ErrorE_" + fileID).html("<span class='text-danger'> " + error + " </span>");
                        $("#UpdateE_" + fileID).val('');
                    }
                });
                $("#docRowE_" + fileID).removeClass("Uploadloader");

                $("#docRowE_" + fileID).removeClass("Uploadloader");
                $("#UpdateE_" + fileID).val('');
                var progBox = '#progressE_' + fileID + ' .progress-bar';

                $(progBox).css(
                    'width',
                    0 + '%'
                ).text("");
            },
            progressall: function (e, data) {

                $("#docRowE_" + fileID).addClass("Uploadloader");

                var progress = parseInt(data.loaded / data.total * 100, 10);

                var progBox = '#progressE_' + fileID + ' .progress-bar';

                $(progBox).css(
                    'width',
                    progress + '%'
                ).text(progress + '%');
            }

        });
    }



    function updateBrowse(id) {
        $("#UpdateE_" + id).click();
    }



    /*
     * Deleteing a document...
     */
    function DeleteDocument(id, fileID, DocType) {

        var msg = confirm("Are you sure you want to delete this document?");

        if (msg === true) {

            $.post("/Helpers/DeleteCompanyDocument", { "CompElpsDocID": id, "DocType": DocType }, function (response) {
                if (response.trim() === "Network Error") {
                    $("#Error_" + fileID).html("<span class='text-danger'> No Network. Please check your network. </span>");
                }
                else {

                    if (response.trim() === "Document Deleted") {
                        $("#Error_" + fileID).html("<b style='color:green'> Document deleted successfully... Please wait </b>");
                        $("#docTable").load(location.href + " #docTable");
                    }
                    else {
                        $("#Error_" + fileID).html("<span class='text-danger'> Error " + response + " </span>");
                    }
                }
            });
        }
    }



    function Reload() {
        location.reload(true);
    }

</script>